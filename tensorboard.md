tensorboard --logdir=tensorboard_log --host=localhost --port=6006

제공해주신 trading_env.py 소스 코드와 TensorBoard 학습 로그 이미지를 분석하여 정리한 마크다운(.md) 파일 내용입니다. 아래 내용을 복사하여 사용하시면 됩니다.

Markdown

# 📈 RL 트레이딩 모델 학습 지표 분석 가이드

이 문서는 PPO(Proximal Policy Optimization) 알고리즘 기반의 BTCUSDT 선물 거래 환경에서 기록되는 주요 지표의 의미와 이상적인 학습 방향을 설명합니다.

---

## 1. Train 지표 (모델 학습 최적화 상태)
에이전트의 신경망이 데이터로부터 얼마나 효율적으로 배우고 있는지를 나타냅니다.

| 지표명 | 설명 | 이상적인 학습 방향 |
| :--- | :--- | :--- |
| **approx_kl** | 정책 업데이트 전후의 확률 분포 차이(KL Divergence)입니다. | **안정적인 수치 유지.** 너무 높으면 정책이 급변하여 학습이 붕괴될 수 있고, 너무 낮으면 학습 속도가 느립니다. |
| **clip_fraction** | PPO 알고리즘에서 급격한 변화를 막기 위해 업데이트가 클리핑된 비율입니다. | **0.1 ~ 0.2 내외.** 너무 높으면 정책 변화가 지나치게 억제되고 있음을 의미합니다. |
| **entropy_loss** | 에이전트 행동의 불확실성(탐험 정도)을 나타냅니다. | **서서히 하락.** 초기에는 다양한 시도를 위해 높아야 하며, 학습이 진행될수록 전략을 확정하며 낮아져야 합니다. |
| **explained_variance** | 가치 함수(Value Function)가 실제 수익을 얼마나 잘 예측하는지 측정합니다. | **1.0에 근접.** 0보다 작으면 무작위 예측보다 나쁜 상태이며, 최소 0.5 이상으로 올라와야 수익 기댓값을 제대로 판단하는 것입니다. |
| **value_loss** | 상태 가치 예측값과 실제 수익 사이의 오차입니다. | **장기적으로 하락.** 에이전트가 시장 상황에 따른 유리함/불리함을 정확히 인지할수록 줄어듭니다. |

---

## 2. Rollout & Eval 지표 (실제 거래 성과)
학습 중 또는 평가 과정에서 에이전트가 환경과 상호작용하며 얻은 결과입니다.

| 지표명 | 설명 | 이상적인 학습 방향 |
| :--- | :--- | :--- |
| **ep_rew_mean** | 에피소드당 평균 누적 보상입니다. | **지속적인 우상향.** 모델 성능을 판단하는 가장 직접적인 지표입니다. |
| **ep_len_mean** | 에피소드가 종료될 때까지의 평균 스텝 수입니다. | **최대 스텝(1000) 유지.** 강제 청산(Liquidation)이 잦으면 이 값이 짧아지므로, 생존 능력이 길어지는지 확인해야 합니다. |

---

## 3. Trading 커스텀 지표 (전략 성과 분석)
`trading_env.py` 환경에서 직접 정의된 트레이딩 특화 지표들입니다.

* **return_pct (수익률):** 초기 자산($10,000) 대비 최종 수익률입니다. 마이너스에서 시작하더라도 점진적으로 **양수(+) 방향으로 우상향**해야 합니다.
* **is_liquidated (강제 청산):** 20배 레버리지 환경에서 가격이 역방향으로 2.5% 이상 움직여 청산되었는지 여부입니다. 학습이 진행될수록 **0에 수렴**해야 합니다.
* **max_equity_ratio (최고 자산 비율):** 에피소드 중 달성한 최대 자산의 비율입니다. 이 값이 높아질수록 에이전트가 수익 구간에서 적절히 포지션을 유지하거나 피라미딩(추가 진입)을 잘 수행했다는 의미입니다.

---

## 4. 종합 평가 및 학습 성공 징후

### ✅ 긍정적인 신호 (Good Signs)
1.  **Reward와 Return의 동기화:** `ep_rew_mean`이 오를 때 실질 수익률인 `return_pct`도 함께 오른다면 보상 함수가 적절히 설계된 것입니다.
2.  **생존 시간의 증가:** `ep_len_mean`이 환경 설정값인 1,000에 수렴하고 `is_liquidated`가 낮아진다면, 모델이 높은 레버리지 리스크를 관리하기 시작한 것입니다.
3.  **예측 정확도 향상:** `explained_variance`가 0.5를 넘어 1.0에 가까워지면 모델이 '수익이 날 상황'을 통계적으로 이해하고 있다는 뜻입니다.

### ⚠️ 주의가 필요한 신호 (Warning Signs)
1.  **Entropy의 급격한 소멸:** 탐험을 멈추고 하나의 행동(예: 계속 Hold만 함)에 고착될 경우 발생합니다.
2.  **KL Divergence 폭발:** `approx_kl` 수치가 너무 튀면 학습률(Learning Rate)이 너무 높거나 환경이 불안정한 것이므로 조절이 필요합니다.
다음에 도움이 필요한 사항이 있으신가요?